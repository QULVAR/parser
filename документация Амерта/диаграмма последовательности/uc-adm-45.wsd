@startuml
title Диаграмма последовательности: Управление промокодами (Администратор)
actor Администратор as Admin
participant "UI (МП)" as UI
participant "Сервис валидации" as ValidationService
participant "Промокод сервис" as PromoService
participant "База данных" as DB

== Создание промокода ==

Admin -> UI: Нажимает кнопку создания промокода
UI -> Admin:  Создает новую строку в таблицу

Admin -> UI: Вводит данные промокода
UI -> ValidationService: Валидирует формат данных
alt Валидация не пройдена (ERR-02)
    ValidationService -> UI: Возвращает ошибки валидации
    UI -> Admin: Подсвечивает поля с ошибками\nи показывает сообщение
    UI -> Admin: Кнопка "Сохранить" остаётся некликабельной
else Валидация пройдена
    UI -> Admin: Кнопка "Сохранить" становится кликабельной
    Admin -> UI: Нажимает кнопку "Сохранить"
    UI -> PromoService: Запрос на создание промокода\n(данные + проверка уникальности)
    
    PromoService -> DB: Проверка существования промокода
    alt Промокод уже существует (ERR-03)
        DB -> PromoService: Возвращает информацию о существующем промокоде
        PromoService -> UI: "Промокод с таким значением уже существует"
        UI -> Admin: Отображает сообщение об ошибке
    else Промокод уникален
        PromoService -> DB: Сохраняет новый промокод
        DB -> PromoService: Подтверждение успешного создания
        PromoService -> UI: Успешный ответ
        UI -> Admin: Отображает уведомление об успешном создании промокода
    end
    
    alt Ошибка сервера (ERR-01) на любом этапе
        UI -> Admin: "Внутренняя ошибка сервиса. Попробуйте позже"
        UI -> UI: Сохраняет введённые данные в форме
    end
end

== Удаление промокода ==

Admin -> UI: Нажимает кнопку удаления промокода\n(рядом с конкретным промокодом)
UI -> PromoService: Запрос на удаление промокода

PromoService -> DB: Удаляет промокод
alt Ошибка сервера (ERR-01)
    DB -> PromoService: Возвращает ошибку
    PromoService -> UI: "Внутренняя ошибка сервиса. Попробуйте позже"
    UI -> Admin: Отображает сообщение об ошибке
else Успешное удаление
    DB -> PromoService: Подтверждение удаления
    PromoService -> UI: Успешный ответ
    UI -> Admin: Отображает уведомление об успешном удалении промокода
end

@enduml