@startuml

title Диаграмма последовательности: Личный кабинет пользователя
actor Пользователь as User
actor Администратор as Admin
participant "UI (МП)" as UI
participant "Сервис сессий" as SessionService
participant "Сервис профиля" as ProfileService
participant "База данных" as DB

== Открытие личного кабинета ==

User -> UI: Нажимает на вкладку "Личный кабинет"
UI -> SessionService: Запрос текущей сессии
SessionService -> DB: Проверка активной сессии
DB -> SessionService: Данные пользователя
SessionService -> UI: Возвращает данные пользователя

UI -> ProfileService: Запрос профиля пользователя
ProfileService -> DB: Получение деталей профиля
DB -> ProfileService: Возвращает профиль (имя, email, роль)
ProfileService -> UI: Передаёт данные профиля

UI -> User: Отображает модальное окно с информацией

alt Пользователь является администратором
    UI -> User: Добавляет кнопку "Админ-панель" в форму
end

== Обработка ошибок ==

alt Ошибка сервера (ERR-01) при запросе профиля
    UI -> User: "Внутренняя ошибка сервиса. Попробуйте позже"
    UI -> UI: Закрывает модальное окно личного кабинета
end


== Выход из системы ==

User -> UI: Нажимает кнопку "Выход"
UI -> SessionService: Запрос на завершение сессии
SessionService -> DB: Удаление сессии
DB -> SessionService: Подтверждение удаления
SessionService -> UI: Успешный ответ
UI -> UI: Перенаправляет на страницу аутентификации
UI -> User: Отображает экран входа в систему

== Переход в админ-панель (для администратора) ==

Admin -> UI: Нажимает кнопку "Админ-панель"
UI -> SessionService: Проверка прав администратора
SessionService -> DB: Проверка роли пользователя
DB -> SessionService: Подтверждение роли администратора
SessionService -> UI: Разрешение доступа
UI -> UI: Открывает админ-панель поверх главной страницы
UI -> Admin: Отображает интерфейс администрирования

@enduml